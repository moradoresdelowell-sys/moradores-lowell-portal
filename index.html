<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moradores de Lowell - Portal Digital</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK - uma vez s√≥ -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- Config Firebase -->
    <script src="firebase-config.js"></script>
</head>
<body>
    <!-- Header simples -->

<!-- Destaques Premium na Index -->
<section id="destaques-premium" class="destaques-section">
    <div class="container">
        <h2 class="destaques-titulo">üéØ Estabelecimentos Destacados</h2>
        <div class="destaques-grid" id="destaquesPremium">
            <!-- Vai preencher com JavaScript -->
            <div class="loading">Carregando destaques...</div>
        </div>
    </div>
</section>

    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>Moradores de Lowell</h1>
                <p>Portal Digital</p>
            </div>
            <nav class="nav-menu">
                <ul class="nav-list">
                    <li><a href="#home" class="nav-link active">In√≠cio</a></li>
                    <li><a href="#classificados" class="nav-link">Classificados</a></li>
                    <li><a href="#empregos" class="nav-link">Empregos</a></li>
                    <li><a href="#guia" class="nav-link">Guia</a></li>
                    <li><a href="#noticias" class="nav-link">Not√≠cias</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Conte√∫do principal -->
    <main class="main-content">
        <!-- Se√ß√£o Home -->
        <section id="home" class="content-section active">
            <div class="welcome-section">
                <h2>Bem-vindo ao Portal</h2>
                <p>Tudo para a comunidade brasileira de Lowell</p>
            </div>
        </section>

        <!-- Se√ß√£o Classificados -->
        <section id="classificados" class="content-section">
            <h2>Classificados</h2>
            <div class="anuncios-grid" id="anunciosGrid">
                <!-- An√∫ncios do Firebase v√£o aqui -->
            </div>
        </section>

        <!-- Se√ß√£o Empregos -->
        <section id="empregos" class="content-section">
            <h2>Empregos</h2>
            <div class="vagas-list" id="vagasList">
                <!-- Vagas do Firebase v√£o aqui -->
            </div>
        </section>

        <!-- Se√ß√£o Guia -->
        <section id="guia" class="content-section">
            <h2>Guia Comercial</h2>
            <div class="estabelecimentos-list" id="estabelecimentosList">
                <!-- Estabelecimentos do Firebase v√£o aqui -->
            </div>
        </section>

        <!-- Se√ß√£o Not√≠cias -->
        <section id="noticias" class="content-section">
            <h2>Not√≠cias</h2>
            <div class="noticias-grid" id="noticiasGrid">
                <!-- Not√≠cias do Firebase v√£o aqui -->
            </div>
        </section>
    </main>

    <!-- Footer simples -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Moradores de Lowell</p>
        </div>
    </footer>

<!-- Player de R√°dio Global Fixo -->
<div class="radio-player-fixed">
    <div class="radio-info">
        <img src="radio-logo.png" alt="R√°dio" class="radio-logo-mini">
        <div class="radio-text">
            <span class="radio-title">MDL Radio</span>
            <span class="radio-program">Manh√£ Brasileira</span>
        </div>
    </div>
    
    <div class="radio-controls">
        <button class="control-btn" id="radioPlayBtn">
            <i class="fas fa-play" id="radioIcon"></i>
        </button>
        <input type="range" id="radioVolume" min="0" max="100" value="50">
        <button class="control-btn" id="radioMuteBtn">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>
    
    <audio id="radioAudio" preload="none">
        <source src="https://stream.radio.comunidade.lowell/live" type="audio/mpeg">
    </audio>
</div>

<script>
// Sistema de Destaques Premium - Index
async function carregarDestaquesPremium() {
    try {
        console.log("Carregando destaques premium...");
        
        const destaquesRef = firebase.firestore().collection('estabelecimentos');
        const snapshot = await destaquesRef
            .where('destaque.tipo', '==', 'premium')
            .where('destaque.ativo', '==', true)
            .orderBy('destaque.posicao')
            .limit(3)
            .get();
        
        const destaques = [];
        snapshot.forEach(doc => {
            destaques.push({ id: doc.id, ...doc.data() });
        });
        
        console.log("Destaques carregados:", destaques);
        renderizarDestaquesPremium(destaques);
        
    } catch (error) {
        console.error("Erro ao carregar destaques:", error);
        mostrarMensagemSemDestaques();
    }
}

function renderizarDestaquesPremium(destaques) {
    const container = document.getElementById('destaquesPremium');
    if (!container) return;
    
    if (destaques.length === 0) {
        mostrarMensagemSemDestaques();
        return;
    }
    
    container.innerHTML = `
        <div class="destaques-grid">
            ${destaques.map((estab, index) => `
                <div class="destaque-premium-card">
                    <div class="destaque-premium-header">
                        <span class="destaque-premium-badge">‚òÖ PREMIUM ‚òÖ</span>
                        <span class="destaque-posicao">Posi√ß√£o ${index + 1}</span>
                    </div>
                    
                    ${estab.imagem ? `<img src="${estab.imagem}" alt="${estab.nome}" class="destaque-premium-imagem">` : '<div class="sem-imagem">Sem imagem</div>'}
                    
                    <h3 class="destaque-premium-nome">${estab.nome}</h3>
                    <p class="destaque-premium-categoria">${estab.categoria}</p>
                    <p class="destaque-premium-descricao">${estab.descricao}</p>
                    
                    <div class="destaque-premium-info">
                        <p class="destaque-premium-endereco"><i class="fas fa-map-marker-alt"></i> ${estab.endereco}</p>
                        <p class="destaque-premium-horario"><i class="fas fa-clock"></i> ${estab.horario}</p>
                        <div class="destaque-premium-estrelas">${renderizarEstrelas(estab.avaliacao)}</div>
                    </div>
                    
                    <div class="destaque-premium-actions">
                        <button class="destaque-premium-btn" onclick="abrirWhatsApp('${estab.telefone}')">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="destaque-premium-btn" onclick="ligarPara('${estab.telefone}')">
                            <i class="fas fa-phone"></i> Ligar
                        </button>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

function renderizarEstrelas(avaliacao) {
    const estrelasCheias = Math.floor(parseFloat(avaliacao));
    const temMeiaEstrela = parseFloat(avaliacao) % 1 !== 0;
    let html = '';
    
    for (let i = 0; i < estrelasCheias; i++) {
        html += '<i class="fas fa-star"></i>';
    }
    if (temMeiaEstrela) {
        html += '<i class="fas fa-star-half-alt"></i>';
    }
    for (let i = estrelasCheias + (temMeiaEstrela ? 1 : 0); i < 5; i++) {
        html += '<i class="far fa-star"></i>';
    }
    return html;
}

function mostrarMensagemSemDestaques() {
    const container = document.getElementById('destaquesPremium');
    if (container) {
        container.innerHTML = `
            <div class="sem-destaques">
                <i class="fas fa-store"></i>
                <h3>Em breve destaques premium!</h3>
                <p>Estabelecimentos premium aparecer√£o aqui.</p>
            </div>
        `;
    }
}

// Fun√ß√µes auxiliares
function abrirWhatsApp(telefone) {
    window.open(`https://wa.me/1${telefone.replace(/\D/g, '')}`, '_blank');
}

function ligarPara(telefone) {
    window.location.href = `tel:${telefone}`;
}

// Iniciar quando a p√°gina carregar
document.addEventListener('DOMContentLoaded', function() {
    console.log("‚úÖ Iniciando sistema de destaques premium...");
    carregarDestaquesPremium();
});
</script>

    <!-- Scripts ESSENCIAIS -->
    <script src="script.js"></script>
    <script src="firebase-loader.js"></script>
</body>
</html>